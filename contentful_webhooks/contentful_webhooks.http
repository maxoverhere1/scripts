### Contentful Webhook Management - HTTP/curl commands
### Based on: https://www.contentful.com/developers/docs/webhooks/configure-webhook/

# Your Contentful credentials
@space_id = nuloos7fnddp
@environment = dev
@management_token = xxx
@base_url = https://api.contentful.com

### 1. List all webhooks
GET {{base_url}}/spaces/{{space_id}}/webhook_definitions
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json

### 2. Get specific webhook (replace WEBHOOK_ID with actual ID)
GET {{base_url}}/spaces/{{space_id}}/webhook_definitions/WEBHOOK_ID
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json

### 3. Create simple webhook (listens to all events)
POST {{base_url}}/spaces/{{space_id}}/webhook_definitions
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json

{
  "name": "My Simple Webhook",
  "url": "https://webhook.site/your-unique-url",
  "topics": ["*.*"],
  "filters": []
}

### 4. Create webhook for Entry events only
POST {{base_url}}/spaces/{{space_id}}/webhook_definitions
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json

{
  "name": "Entry Events Webhook",
  "url": "https://webhook.site/your-unique-url",
  "topics": ["Entry.publish", "Entry.unpublish", "Entry.delete"],
  "filters": []
}

### 5. Create webhook with environment filter (dev and master only)
POST {{base_url}}/spaces/{{space_id}}/webhook_definitions
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json

{
  "name": "Filtered Environment Webhook",
  "url": "https://webhook.site/your-unique-url",
  "topics": ["*.*"],
  "filters": [
    {
      "in": [
        {
          "doc": "sys.environment.sys.id"
        },
        [
          "dev",
          "master"
        ]
      ]
    }
  ]
}

### 6. Create webhook with HTTP Basic Auth
POST {{base_url}}/spaces/{{space_id}}/webhook_definitions
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json

{
  "name": "Authenticated Webhook",
  "url": "https://your-secure-endpoint.com/webhook",
  "topics": ["Entry.publish", "Asset.publish"],
  "filters": [],
  "httpBasicUsername": "your_username",
  "httpBasicPassword": "your_password"
}

### 7. Create webhook with custom headers
POST {{base_url}}/spaces/{{space_id}}/webhook_definitions
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json

{
  "name": "Custom Headers Webhook",
  "url": "https://your-endpoint.com/webhook",
  "topics": ["*.*"],
  "filters": [],
  "headers": [
    {
      "key": "X-Custom-Header",
      "value": "MyCustomValue"
    },
    {
      "key": "Authorization",
      "value": "Bearer your-token-here"
    }
  ]
}

### 8. Update webhook (replace WEBHOOK_ID with actual ID)
PUT {{base_url}}/spaces/{{space_id}}/webhook_definitions/WEBHOOK_ID
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json
X-Contentful-Version: 1

{
  "name": "Updated Webhook Name",
  "url": "https://new-endpoint.com/webhook",
  "topics": ["Entry.*"],
  "filters": []
}

### 9. Create webhook for local development server
POST {{base_url}}/spaces/{{space_id}}/webhook_definitions
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json

{
  "name": "Local Development Webhook",
  "url": "http://localhost:5000/webhook",
  "topics": ["Entry.publish", "Entry.unpublish", "Entry.save", "Asset.publish", "Asset.unpublish", "Asset.save"],
  "filters": [],
  "headers": [
    {
      "key": "X-Local-Dev",
      "value": "true"
    }
  ]
}

### 10. Delete webhook (replace WEBHOOK_ID with actual ID)
DELETE {{base_url}}/spaces/{{space_id}}/webhook_definitions/WEBHOOK_ID
Authorization: Bearer {{management_token}}
Content-Type: application/vnd.contentful.management.v1+json
